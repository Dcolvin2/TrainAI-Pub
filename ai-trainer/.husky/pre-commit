#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run ESLint with auto-fix on staged files
echo "ğŸ“ Checking and fixing code style..."
npx lint-staged

# Run TypeScript type checking
echo "ğŸ”§ Checking TypeScript types..."
npm run type-check

# If TypeScript check fails, prevent commit
if [ $? -ne 0 ]; then
    echo "âŒ TypeScript errors found. Commit blocked."
    echo "ğŸ’¡ Run 'npm run type-check' to see details."
    exit 1
fi

# Run a quick build check
echo "ğŸ—ï¸ Running build check..."
npm run build --silent

# If build fails, prevent commit
if [ $? -ne 0 ]; then
    echo "âŒ Build errors found. Commit blocked."
    echo "ğŸ’¡ Run 'npm run build' to see details."
    exit 1
fi

echo "âœ… All checks passed! Proceeding with commit." 